<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Portal</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body class="lang-en">
    <!-- Fondo animado de estrellas -->
    <div class="stars" id="starsContainer"></div>
    <video id="video-background" autoplay muted loop playsinline>
        <source src="assets/videofondoingles.mp4" type="video/mp4">
    </video>

    <!-- Contenedor principal -->
    <div class="container">
        <!-- Secci√≥n del t√≠tulo -->
        <div class="title-section">
            <h1 class="title">üåü Cosmic Portal üåü</h1>
            <p class="subtitle">Explore the wonderful mysteries of space weather</p>
        </div>

        <!-- Contenedor del c√≠rculo principal -->
        <div class="circular-container">
            <!-- Settings en esquina superior izquierda -->
            <div class="section-circle section-3" data-section="3" onclick="selectSection(3)">
                <div class="section-content">
                    <div class="section-icon">‚öôÔ∏è</div>
                    <h3>Settings</h3>
                </div>
            </div>

            <div class="main-circle" id="mainCircle">

                <!-- COLUMNA IZQUIERDA: 2 c√≠rculos -->
                <div class="left-circles">
                    <!-- Secci√≥n 1: Story (arriba) -->
                    <div class="section-circle section-1 active" data-section="1" onclick="selectSection(1)">
                        <div class="section-content">
                            <div class="section-icon">
                                <video class="section-video" autoplay muted loop playsinline>
                                    <source src="assets/principal/vidintrocuento.mp4" type="video/mp4">
                                </video>
                            </div>
                            <h3>Story</h3>
                        </div>
                    </div>

                    <!-- Secci√≥n 2: Flashcards (abajo) -->
                    <div class="section-circle section-2" data-section="2" onclick="selectSection(2)">
                        <div class="section-content">
                            <div class="section-icon">
                                <video class="section-video" autoplay muted loop playsinline>
                                    <source src="assets/principal/vidintroflashcards.mp4" type="video/mp4">
                                </video>
                            </div>
                            <h3>Flashcards</h3>
                            <a href="flashcards_english.html" class="section-link"></a>
                        </div>
                    </div>
                </div>

                <!-- CENTRO: Imagen principal -->
                <div class="center-image main-highlight" id="centerImage">
                    <div class="center-placeholder">
                        <div class="placeholder-icon">üåé</div>
                    </div>
                </div>

                <!-- COLUMNA DERECHA: 2 c√≠rculos -->
                <div class="right-circles">
                    <!-- Secci√≥n 4: Inclusive Logbook (arriba) -->
                    <div class="section-circle section-4" data-section="4" onclick="selectSection(4)">
                        <div class="section-content">
                            <div class="section-icon">
                                <video class="section-video" autoplay muted loop playsinline>
                                    <source src="assets/principal/vidintroinclusivo.mp4" type="video/mp4">
                                </video>
                            </div>
                            <h3>Inclusive Logbook</h3>
                        </div>
                    </div>

                    <!-- Secci√≥n 5: Curious Facts (abajo) -->
                    <div class="section-circle section-5" data-section="5" onclick="selectSection(5)">
                        <div class="section-content">
                            <div class="section-icon">
                                <video class="section-video" autoplay muted loop playsinline>
                                    <source src="assets/principal/vidintrodatoscuriosos.mp4" type="video/mp4">
                                </video>
                            </div>
                            <h3>Curious Facts</h3>
                            <a href="datoscuriosos_english.html" class="section-link"></a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contenedor inferior izquierdo (con logo y bot√≥n) -->
            <div class="bottom-left-container">
                <img src="assets/logohumboldt.png" alt="Imagen decorativa">
                <!-- Bot√≥n Aplicando Nuestro Proyecto -->
                <button class="project-btn" onclick="openProjectModal()">
                    <span class="project-icon">üöÄ</span>
                    <span class="project-text">Applying Our Project</span>
                </button>
            </div>

            <!-- Contenedor inferior derecho (circular) -->
            <div class="bottom-right-container">
                <div class="circle-image-placeholder">
                    <img src="assets/logocassiopeiaseniorsf.png" alt="Imagen decorativa">
                </div>
                <!-- Who We Are - clickeable -->
                <button class="who-we-are-btn" onclick="openAboutModal()">
                    <span class="who-icon">üë•</span>
                    <span class="who-text">Who Are We?</span>
                </button>
            </div>
        </div>

        <!-- Controles de navegaci√≥n -->
        <div class="navigation-controls">
            <button class="nav-btn nav-prev" onclick="previousSection()">‚ùÆ</button>
            <button class="nav-btn nav-next" onclick="nextSection()">‚ùØ</button>
        </div>

        <!-- Indicadores de secci√≥n -->
        <div class="section-indicators">
            <span class="indicator active" data-section="1" onclick="goToSection(1)"></span>
            <span class="indicator" data-section="2" onclick="goToSection(2)"></span>
            <span class="indicator" data-section="3" onclick="goToSection(3)"></span>
            <span class="indicator" data-section="4" onclick="goToSection(4)"></span>
            <span class="indicator" data-section="5" onclick="goToSection(5)"></span>
        </div>
    </div>

    <!-- Modal de Informaci√≥n de Secci√≥n -->
    <div class="section-modal" id="sectionModal">
        <div class="modal-overlay" onclick="closeSectionModal()"></div>
        <div class="modal-content section-modal-content">
            <div class="modal-header">
                <h3 id="sectionModalTitle">Section Title</h3>
                <button class="close-btn" onclick="closeSectionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p id="sectionModalContent">Section content...</p>
                <div id="sectionModalActions"></div>
            </div>
        </div>
    </div>

    <!-- Modal Who Are We -->
    <div class="about-modal" id="aboutModal">
        <div class="modal-overlay" onclick="closeAboutModal()"></div>
        <div class="modal-content about-modal-content">
            <div class="modal-header">
                <h3>üë• Who Are We?</h3>
                <button class="close-btn" onclick="closeAboutModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p>[Reserved space for content - Information about the team and project will be added soon. This section
                    will include details about our mission, vision, and the people behind this Space Portal project.]
                </p>
            </div>
        </div>
    </div>

    <!-- Modal Aplicando Nuestro Proyecto -->
    <div class="project-modal" id="projectModal">
        <div class="modal-overlay" onclick="closeProjectModal()"></div>
        <div class="modal-content project-modal-content">
            <div class="modal-header">
                <h3>üöÄ Applying Our Project</h3>
                <button class="close-btn" onclick="closeProjectModal()">√ó</button>
            </div>
            <div class="modal-body">

                <!-- Galer√≠a de im√°genes -->
                <div class="applications-gallery" id="applicationsGallery">
                    <!-- Las im√°genes se cargar√°n din√°micamente aqu√≠ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Material de Inclusi√≥n -->
    <div class="inclusion-modal" id="inclusionModal">
        <div class="modal-overlay" onclick="closeInclusionModal()"></div>
        <div class="modal-content inclusion-modal-content">
            <div class="modal-header">
                <h3>üåç Inclusive Logbook</h3>
                <button class="close-btn" onclick="closeInclusionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="inclusion-buttons">
                    <button class="inclusion-btn" onclick="openVocabModal()">
                        <div class="icon">‚†É</div>
                        <div class="text">Braille Language</div>
                    </button>
                    <a href="glosario_english.html" class="inclusion-btn">
                        <div class="icon">üëã</div>
                        <div class="text">Sign Language</div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Braille Language -->
    <div class="vocab-modal" id="vocabModal">
        <div class="modal-overlay" onclick="closeVocabModal()"></div>
        <div class="modal-content vocab-modal-content">
            <div class="modal-header">
                <h3>‚†É Braille Language</h3>
                <button class="close-btn" onclick="closeVocabModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="vocab-buttons">
                    <button class="vocab-btn" onclick="window.open('narrativasonora_english.html')">
                        <div class="icon">üîä</div>
                        <div class="text">Sound Narrative</div>
                    </button>
                    <button class="vocab-btn" onclick="openBrailleCardsModal()">
                        <div class="icon">üìÑ</div>
                        <div class="text">Braille Cards to Print</div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Braille Cards -->
    <div class="braille-cards-modal" id="brailleCardsModal">
        <div class="modal-overlay" onclick="closeBrailleCardsModal()"></div>
        <div class="modal-content braille-cards-modal-content">
            <div class="modal-header">
                <h3>üìÑ Braille Cards to Print</h3>
                <button class="close-btn" onclick="closeBrailleCardsModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="braille-cards-buttons">
                    <button class="braille-card-btn"
                        onclick="window.open('assets/braille/personajesbraille.pdf', '_blank')">
                        <div class="icon">üë•</div>
                        <div class="text">Characters Cards</div>
                    </button>
                    <button class="braille-card-btn"
                        onclick="window.open('assets/braille/vocabulariobraille.pdf', '_blank')">
                        <div class="icon">üìö</div>
                        <div class="text">Vocabulary Cards</div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Configuraci√≥n de Idioma -->
    <div class="config-modal" id="configModal">
        <div class="modal-overlay" onclick="closeConfigModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>üåç Language Configuration</h3>
                <button class="close-btn" onclick="closeConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="language-selector">
                    <div class="language-buttons">
                        <button class="lang-btn active" data-lang="en">
                            <span class="flag">üá∫üá∏</span>
                            <span class="lang-text">English</span>
                        </button>
                        <button class="lang-btn" data-lang="es" onclick="showLanguageWarning('es')">
                            <span class="flag">üá™üá∏</span>
                            <span class="lang-text">Spanish</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Animated Story Options -->
    <div class="animated-story-modal" id="animatedStoryModal">
        <div class="modal-overlay" onclick="closeAnimatedStoryModal()"></div>
        <div class="modal-content animated-story-modal-content">
            <div class="modal-header">
                <h3>üé® Animated Story</h3>
                <button class="close-btn" onclick="closeAnimatedStoryModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="story-version-buttons">
                    <a href="https://www.youtube.com/watch?v=SBwpvaiPY0U" class="version-btn">
                        <span class="btn-icon">‚è±Ô∏è</span>
                        <span class="btn-text">Short Version</span>
                    </a>
                    <a href="https://www.youtube.com/watch?v=S1rZiJ1_fcU&t=949s" class="version-btn">
                        <span class="btn-icon">üìΩÔ∏è</span>
                        <span class="btn-text">Long Version</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Advertencia de Idioma -->
    <div class="warning-modal" id="languageWarningModal">
        <div class="modal-overlay" onclick="closeLanguageWarning()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Language Change Warning</h3>
            </div>
            <div class="modal-body">
                <p id="warningMessage"></p>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeLanguageWarning()">Cancel</button>
                <button class="btn-confirm" id="confirmButton" onclick="confirmLanguageChange()">Continue</button>
            </div>
        </div>
    </div>

    <script>
        let currentSection = 1;
        let totalSections = 5;
        let pendingLanguage = null;

        const sectionData = {
            1: {
                title: "Story",
                content: "",
                buttons: [
                    { text: "Read Story", link: "https://heyzine.com/flip-book/3b6466dc58.html", icon: "üìñ" },
                    { text: "View Animated Story", action: "openAnimatedStoryModal", icon: "üé®" }
                ],
                color: "#4fc3f7"
            },
            2: {
                title: "Space Flashcards",
                content: "Learn fascinating facts about the universe with our interactive cards. Perfect for expanding your knowledge about the cosmos.",
                link: "flashcards_english.html",
                linkText: "Explore Flashcards",
                color: "#e1bee7"
            },
            3: {
                title: "Settings",
                content: "Customize your experience on the Space Portal. Change the language and adjust the preferences according to your needs.",
                link: null,
                action: "openConfigModal",
                linkText: "Open Settings",
                color: "#ff9800"
            },
            4: {
                title: "Inclusive Material",
                content: "",
                link: null,
                action: "openInclusionModal",
                linkText: "View Options",
                color: "#ffc107"
            },
            5: {
                title: "Curious Facts",
                content: "Discover amazing facts about stellar weather and space meteorological phenomena. Get ready to be amazed!",
                link: "datoscuriosos_english.html",
                linkText: "Did you know?",
                color: "#4caf50"
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                initializePortal();
                createStars();
                setupEventListeners();
                loadLanguagePreference();
            }, 100);
        });

        function initializePortal() {
            setActiveSection(currentSection);
            checkCustomImage();
            console.log('Space Portal initialized');
        }

        function checkCustomImage() {
            const centerImg = document.getElementById('centerImg');
            const placeholder = document.querySelector('.center-placeholder');

            if (centerImg && placeholder) {
                centerImg.onload = function () {
                    centerImg.style.display = 'block';
                    placeholder.style.display = 'none';
                };

                centerImg.onerror = function () {
                    centerImg.style.display = 'none';
                    placeholder.style.display = 'flex';
                };

                if (centerImg.complete && centerImg.naturalWidth > 0) {
                    centerImg.style.display = 'block';
                    placeholder.style.display = 'none';
                } else if (centerImg.complete) {
                    centerImg.style.display = 'none';
                    placeholder.style.display = 'flex';
                }
            }
        }

        function previousSection() {
            currentSection = currentSection === 1 ? totalSections : currentSection - 1;
            setActiveSection(currentSection);
        }

        function nextSection() {
            currentSection = currentSection === totalSections ? 1 : currentSection + 1;
            setActiveSection(currentSection);
        }

        function goToSection(sectionNumber) {
            currentSection = sectionNumber;
            setActiveSection(currentSection);
        }

        function selectSection(sectionNumber) {
            if (sectionNumber === 4) {
                openInclusionModal();
            } else {
                openSectionModal(sectionNumber);
            }

            if (sectionNumber !== currentSection) {
                goToSection(sectionNumber);
            }
        }

        function setActiveSection(sectionNumber) {
            document.querySelectorAll('.section-circle').forEach(section => {
                section.classList.remove('active');
            });

            document.querySelectorAll('.indicator').forEach(indicator => {
                indicator.classList.remove('active');
            });

            const activeSection = document.querySelector(`.section-${sectionNumber}`);
            const activeIndicator = document.querySelector(`.indicator[data-section="${sectionNumber}"]`);

            if (activeSection) {
                activeSection.classList.add('active');
            }

            if (activeIndicator) {
                activeIndicator.classList.add('active');
            }
        }

        function openSectionModal(sectionNumber) {
            const modal = document.getElementById('sectionModal');
            const title = document.getElementById('sectionModalTitle');
            const content = document.getElementById('sectionModalContent');
            const actions = document.getElementById('sectionModalActions');
            const data = sectionData[sectionNumber];

            if (!modal || !data) return;

            title.textContent = data.title;
            title.style.color = data.color;
            content.textContent = data.content;

            let actionsHtml = '';

            if (data.buttons && data.buttons.length > 0) {
                actionsHtml = '<div class="story-buttons">';
                data.buttons.forEach(button => {
                    if (button.action) {
                        actionsHtml += `
                            <button class="story-btn" onclick="${button.action}(); closeSectionModal();">
                                <span class="btn-icon">${button.icon}</span>
                                <span class="btn-text">${button.text}</span>
                            </button>
                        `;
                    } else {
                        actionsHtml += `
                            <a href="${button.link}" class="story-btn">
                                <span class="btn-icon">${button.icon}</span>
                                <span class="btn-text">${button.text}</span>
                            </a>
                        `;
                    }
                });
                actionsHtml += '</div>';
            } else if (data.link) {
                actionsHtml = `<a href="${data.link}" class="modal-action-btn">${data.linkText || 'See more'}</a>`;
            } else if (data.linkText && data.action) {
                actionsHtml = `<button class="modal-action-btn" onclick="${data.action}(); closeSectionModal();">${data.linkText}</button>`;
            }

            actions.innerHTML = actionsHtml;

            modal.classList.add('show');
            document.body.classList.add('modal-open');
        }

        function closeSectionModal() {
            const modal = document.getElementById('sectionModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function openAboutModal() {
            const modal = document.getElementById('aboutModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeAboutModal() {
            const modal = document.getElementById('aboutModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function openProjectModal() {
            const modal = document.getElementById('projectModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeProjectModal() {
            const modal = document.getElementById('projectModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function openInclusionModal() {
            const modal = document.getElementById('inclusionModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeInclusionModal() {
            const modal = document.getElementById('inclusionModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function openVocabModal() {
            closeInclusionModal();
            const modal = document.getElementById('vocabModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeVocabModal() {
            const modal = document.getElementById('vocabModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function openAnimatedStoryModal() {
            const modal = document.getElementById('animatedStoryModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeAnimatedStoryModal() {
            const modal = document.getElementById('animatedStoryModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function createStars() {
            const starsContainer = document.getElementById('starsContainer');
            if (!starsContainer) return;

            const numStars = 100;

            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }

            setInterval(createShootingStar, 3000);
        }

        function createShootingStar() {
            const starsContainer = document.getElementById('starsContainer');
            if (!starsContainer) return;

            const shootingStar = document.createElement('div');
            shootingStar.className = 'shooting-star';
            shootingStar.style.top = Math.random() * 50 + '%';
            shootingStar.style.left = '-100px';
            starsContainer.appendChild(shootingStar);

            setTimeout(() => {
                if (shootingStar.parentNode) {
                    shootingStar.remove();
                }
            }, 4000);
        }

        function openConfigModal() {
            const modal = document.getElementById('configModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeConfigModal() {
            const modal = document.getElementById('configModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        function showLanguageWarning(targetLang) {
            const modal = document.getElementById('languageWarningModal');
            const warningMessage = document.getElementById('warningMessage');

            pendingLanguage = targetLang;

            if (targetLang === 'es') {
                warningMessage.textContent = "Please note that when switching to Spanish, only Colombian Sign Language will be used in the sign language section.";
            } else if (targetLang === 'en') {
                warningMessage.textContent = "Please note that when switching to English, only Colombian Sign Language will be used in the sign language section.";
            }

            modal.classList.add('show');
            document.body.classList.add('modal-open');
        }

        function closeLanguageWarning() {
            const modal = document.getElementById('languageWarningModal');
            modal.classList.remove('show');
            document.body.classList.remove('modal-open');
            pendingLanguage = null;
        }

        function confirmLanguageChange() {
            if (pendingLanguage) {
                switchLanguage(pendingLanguage);
                closeLanguageWarning();
                closeConfigModal();
            }
        }

        function switchLanguage(lang) {
            localStorage.setItem('portal-language', lang);

            if (lang === 'es') {
                window.location.href = 'index_spanish.html';
            } else if (lang === 'en') {
                updateLanguageInterface('en');
            }
        }

        function updateLanguageInterface(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }

        function loadLanguagePreference() {
            const savedLang = localStorage.getItem('portal-language') || 'en';
            updateLanguageInterface(savedLang);
        }

        function setupEventListeners() {
            document.addEventListener('keydown', (e) => {
                switch (e.key) {
                    case 'ArrowLeft':
                        previousSection();
                        break;
                    case 'ArrowRight':
                        nextSection();
                        break;
                    case 'Escape':
                        closeConfigModal();
                        closeLanguageWarning();
                        closeSectionModal();
                        closeInclusionModal();
                        closeAboutModal();
                        closeProjectModal();
                        closeVocabModal();
                        closeBrailleCardsModal();
                        closeAnimatedStoryModal();
                        break;
                    case '1':
                    case '2':
                    case '3':
                    case '4':
                    case '5':
                        goToSection(parseInt(e.key));
                        break;
                }
            });

            let startX = 0;
            let endX = 0;

            document.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
            });

            document.addEventListener('touchend', (e) => {
                endX = e.changedTouches[0].clientX;
                handleSwipe();
            });

            function handleSwipe() {
                const swipeThreshold = 50;
                const diffX = startX - endX;

                if (Math.abs(diffX) > swipeThreshold) {
                    if (diffX > 0) {
                        nextSection();
                    } else {
                        previousSection();
                    }
                }
            }

            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal-overlay')) {
                    closeConfigModal();
                    closeLanguageWarning();
                    closeSectionModal();
                    closeInclusionModal();
                    closeAboutModal();
                    closeProjectModal();
                    closeVocabModal();
                    closeBrailleCardsModal();
                    closeAnimatedStoryModal();
                }
            });
        }
    // ========================
        // GALER√çA DE APLICACIONES
        // ========================

        // Configuraci√≥n de im√°genes de aplicaciones
        const applicationsData = [
            { img: "assets/aplicaciones/aplicacion1.jpeg"},
            { img: "assets/aplicaciones/aplicacion2.jpeg"},
            { img: "assets/aplicaciones/aplicacion3.jpeg"},
            { img: "assets/aplicaciones/aplicacion4.jpeg"},
            { img: "assets/aplicaciones/aplicacion5.png"},
            { img: "assets/aplicaciones/aplicacion6.png"}
            // Agrega m√°s im√°genes aqu√≠ siguiendo el mismo formato
        ];

        // Cargar galer√≠a al abrir el modal
        function loadApplicationsGallery() {
            const gallery = document.getElementById('applicationsGallery');
            if (!gallery) return;

            gallery.innerHTML = ''; // Limpiar contenido previo

            applicationsData.forEach((app, index) => {
                const item = document.createElement('div');
                item.className = 'application-item';
                item.onclick = () => openImageViewer(app.img, app.caption);

                item.innerHTML = `
            <img src="${app.img}" alt="${app.caption}" loading="lazy">
            <div class="application-caption">${app.caption || ''}</div>
        `;

                gallery.appendChild(item);
            });
        }

        // Abrir visor de imagen ampliada
        function openImageViewer(imgSrc, caption) {
            // Crear modal si no existe
            let modal = document.getElementById('imageViewerModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'imageViewerModal';
                modal.className = 'image-viewer-modal';
                modal.innerHTML = `
            <div class="image-viewer-content">
                <button class="image-viewer-close" onclick="closeImageViewer()">√ó</button>
                <img id="viewerImage" src="" alt="">
            </div>
        `;
                document.body.appendChild(modal);

                // Cerrar al hacer clic fuera de la imagen
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeImageViewer();
                    }
                });
            }

            const img = document.getElementById('viewerImage');
            img.src = imgSrc;
            img.alt = caption;

            modal.classList.add('show');
        }

        // Cerrar visor de imagen
        function closeImageViewer() {
            const modal = document.getElementById('imageViewerModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // Modificar la funci√≥n openProjectModal existente
        const originalOpenProjectModal = window.openProjectModal;
        window.openProjectModal = function () {
            originalOpenProjectModal();
            loadApplicationsGallery();
        };

        // Hacer funciones globales
        window.loadApplicationsGallery = loadApplicationsGallery;
        window.openImageViewer = openImageViewer;
        window.closeImageViewer = closeImageViewer;

        window.openVocabModal = openVocabModal;
        window.closeVocabModal = closeVocabModal;
        window.previousSection = previousSection;
        window.nextSection = nextSection;
        window.selectSection = selectSection;
        window.goToSection = goToSection;
        window.openSectionModal = openSectionModal;
        window.closeSectionModal = closeSectionModal;
        window.openInclusionModal = openInclusionModal;
        window.closeInclusionModal = closeInclusionModal;
        window.openConfigModal = openConfigModal;
        window.closeConfigModal = closeConfigModal;
        window.showLanguageWarning = showLanguageWarning;
        window.closeLanguageWarning = closeLanguageWarning;
        window.confirmLanguageChange = confirmLanguageChange;
        window.openAboutModal = openAboutModal;
        window.closeAboutModal = closeAboutModal;
        window.openProjectModal = openProjectModal;
        window.closeProjectModal = closeProjectModal;
        window.openAnimatedStoryModal = openAnimatedStoryModal;
        window.closeAnimatedStoryModal = closeAnimatedStoryModal;

        function openBrailleCardsModal() {
            closeVocabModal();
            const modal = document.getElementById('brailleCardsModal');
            if (modal) {
                modal.classList.add('show');
                document.body.classList.add('modal-open');
            }
        }

        function closeBrailleCardsModal() {
            const modal = document.getElementById('brailleCardsModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.classList.remove('modal-open');
            }
        }

        window.openBrailleCardsModal = openBrailleCardsModal;
        window.closeBrailleCardsModal = closeBrailleCardsModal;
    </script>
</body>

</html>