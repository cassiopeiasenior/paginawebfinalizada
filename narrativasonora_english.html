<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound Narrative</title>
    <link rel="stylesheet" href="narrativasonora_styles.css">
</head>

<body>
    <!-- Fondo de estrellas -->
    <div class="stars" id="starsContainer"></div>

    <!-- Bot√≥n de regreso -->
    <a href="index.html" class="back-btn" title="Back to Portal">
        üè†
    </a>

    <!-- Contenedor principal -->
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîä Sound Narrative üîä</h1>
            <p>Explore the space weather through sound. Hover over each card to learn more.</p>

            <!-- Bot√≥n de instrucciones -->
            <div class="instructions-container">
                <button class="audio-btn instructions-btn" onclick="playInstructions()" id="instructionsBtn">
                    <span class="play-icon">‚ñ∂</span>
                </button>
                <span class="instructions-label">Instructions</span>
            </div>

            <div class="speed-selector">
                <label for="globalSpeed">Playback Speed:</label>
                <select id="globalSpeed" onchange="changeGlobalSpeed()">
                    <option value="0.5">0.5x (Very Slow)</option>
                    <option value="0.75">0.75x (Slow)</option>
                    <option value="1" selected>1x (Normal)</option>
                    <option value="1.25">1.25x (Fast)</option>
                    <option value="1.5">1.5x (Very Fast)</option>
                </select>
            </div>
        </div>

        <!-- Grid de narrativas -->
        <div class="narrative-grid">

            <!-- Narrativa 1 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/atmosferaing.m4a">
                <h3 class="narrative-title">Atmosphere</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/atmosfera.png');">
                    <button class="audio-btn" onclick="playAudio(0)" id="audioBtn0">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio0" src="assets/narrativasonora/audio/audioatmosferaingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 2 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/auroraing.m4a">
                <h3 class="narrative-title">Aurora Borealis</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/aurora.JPG');">
                    <button class="audio-btn" onclick="playAudio(1)" id="audioBtn1">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio1" src="assets/narrativasonora/audio/audioauroraingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 3 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/climaespacialing.m4a">
                <h3 class="narrative-title">Space Weather</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/climaespacial.PNG');">
                    <button class="audio-btn" onclick="playAudio(2)" id="audioBtn2">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio2" src="assets/narrativasonora/audio/audioclimaespacialingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 4 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/eyeccioning.m4a">
                <h3 class="narrative-title">Coronal Mass Ejection</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/eyeccion.png');">
                    <button class="audio-btn" onclick="playAudio(3)" id="audioBtn3">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio3" src="assets/narrativasonora/audio/audioeyeccioningles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 5 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/heliosferaing.m4a">
                <h3 class="narrative-title">Heliosphere</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/heliosfera.PNG');">
                    <button class="audio-btn" onclick="playAudio(4)" id="audioBtn4">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio4" src="assets/narrativasonora/audio/audioheliosferaingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 6 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/orbitaing.m4a">
                <h3 class="narrative-title">Orbit</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/orbita.JPG');">
                    <button class="audio-btn" onclick="playAudio(5)" id="audioBtn5">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio5" src="assets/narrativasonora/audio/audioorbitaingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 7 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/llamaradaing.m4a">
                <h3 class="narrative-title">Solar Flare</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/llamarada.png');">
                    <button class="audio-btn" onclick="playAudio(6)" id="audioBtn6">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio6" src="assets/narrativasonora/audio/audiollamaradasolaringles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 8 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/manchaing.m4a">
                <h3 class="narrative-title">Sunspot</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/manchasolar.png');">
                    <button class="audio-btn" onclick="playAudio(7)" id="audioBtn7">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio7" src="assets/narrativasonora/audio/audiomanchassolaringles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 9 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/radiacioning.m4a">
                <h3 class="narrative-title">Radiation</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/radiacion.png');">
                    <button class="audio-btn" onclick="playAudio(8)" id="audioBtn8">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio8" src="assets/narrativasonora/audio/audioradiacioningles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 10 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/sateliteing.m4a">
                <h3 class="narrative-title">Satellite</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/satelite.png');">
                    <button class="audio-btn" onclick="playAudio(9)" id="audioBtn9">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio9" src="assets/narrativasonora/audio/audiosateliteingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 11 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/tormentaing.m4a">
                <h3 class="narrative-title">Solar Storm</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/tormentasolar.png');">
                    <button class="audio-btn" onclick="playAudio(10)" id="audioBtn10">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio10" src="assets/narrativasonora/audio/audiotormentaingles.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 12 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/vientoing.m4a">
                <h3 class="narrative-title">Solar Wind</h3>
                <div class="audio-container"
                    style="background-image: url('assets/narrativasonora/images/vientosolar.png');">
                    <button class="audio-btn" onclick="playAudio(11)" id="audioBtn11">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio11" src="assets/narrativasonora/audio/audiovientoingles.m4a"></audio>
                </div>
            </div>

        </div>
    </div>

    <script>
        // ===== VARIABLES GLOBALES DE AUDIO =====
        let currentAudio = null;
        let currentBtn = null;
        let instructionsAudio = null;
        let hoverSounds = {};
        let globalPlaybackSpeed = 1;

        // ===== INICIALIZACI√ìN =====
        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            initializeAudioPlayers();
            addHoverSounds();
        });

        // ===== CREACI√ìN DE ESTRELLAS =====
        function createStars() {
            const starsContainer = document.getElementById('starsContainer');
            const numStars = 150;

            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // ===== INICIALIZAR REPRODUCTORES =====
        function initializeAudioPlayers() {
            instructionsAudio = new Audio('assets/narrativasonora/audio/audiointroduccioningles.m4a');

            for (let i = 0; i < 12; i++) {
                const audio = document.getElementById(`audio${i}`);
                const btn = document.getElementById(`audioBtn${i}`);

                audio.addEventListener('ended', () => {
                    btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                    btn.classList.remove('playing');
                });
            }

            instructionsAudio.addEventListener('ended', () => {
                const btn = document.getElementById('instructionsBtn');
                btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                btn.classList.remove('playing');
            });
        }

        // ===== AGREGAR SONIDOS DE HOVER =====
        function addHoverSounds() {
            const narrativeCards = document.querySelectorAll('.narrative-card');

            narrativeCards.forEach((card, index) => {
                const hoverAudioSrc = card.getAttribute('data-hover-audio');
                
                if (hoverAudioSrc) {
                    hoverSounds[index] = new Audio(hoverAudioSrc);
                    hoverSounds[index].volume = 0.3;
                }

                card.addEventListener('mouseenter', () => {
                    if (hoverSounds[index]) {
                        playHoverSound(index);
                    }
                });
            });

            const instructionsBtn = document.getElementById('instructionsBtn');
            hoverSounds['instructions'] = new Audio('assets/narrativasonora/audio/hoverinstrucciones.mp3');
            hoverSounds['instructions'].volume = 0.3;
            
            instructionsBtn.addEventListener('mouseenter', () => {
                playHoverSound('instructions');
            });

            const backBtn = document.querySelector('.back-btn');
            hoverSounds['back'] = new Audio('assets/narrativasonora/audio/hoverback.mp3');
            hoverSounds['back'].volume = 0.3;
            
            backBtn.addEventListener('mouseenter', () => {
                playHoverSound('back');
            });
        }

        // ===== REPRODUCIR SONIDO DE HOVER =====
        function playHoverSound(key) {
            if (hoverSounds[key]) {
                hoverSounds[key].currentTime = 0;
                hoverSounds[key].play().catch(error => {
                    console.log('Could not play hover sound:', error);
                });
            }
        }

        // ===== REPRODUCIR AUDIO DE INSTRUCCIONES =====
        function playInstructions() {
            const btn = document.getElementById('instructionsBtn');

            if (currentAudio && !currentAudio.paused) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                if (currentBtn) {
                    currentBtn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                    currentBtn.classList.remove('playing');
                }
            }

            if (instructionsAudio.paused) {
                instructionsAudio.playbackRate = globalPlaybackSpeed;
                instructionsAudio.play();
                btn.innerHTML = '<span class="pause-icon">‚è∏</span>';
                btn.classList.add('playing');
            } else {
                instructionsAudio.pause();
                instructionsAudio.currentTime = 0;
                btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                btn.classList.remove('playing');
            }
        }

        // ===== CAMBIAR VELOCIDAD GLOBAL =====
        function changeGlobalSpeed() {
            const select = document.getElementById('globalSpeed');
            globalPlaybackSpeed = parseFloat(select.value);

            for (let i = 0; i < 12; i++) {
                const audio = document.getElementById(`audio${i}`);
                if (audio) {
                    audio.playbackRate = globalPlaybackSpeed;
                }
            }

            if (instructionsAudio) {
                instructionsAudio.playbackRate = globalPlaybackSpeed;
            }
        }

        // ===== REPRODUCIR AUDIO DE NARRATIVAS =====
        function playAudio(index) {
            const audio = document.getElementById(`audio${index}`);
            const btn = document.getElementById(`audioBtn${index}`);

            if (instructionsAudio && !instructionsAudio.paused) {
                instructionsAudio.pause();
                instructionsAudio.currentTime = 0;
                const instructionsBtn = document.getElementById('instructionsBtn');
                instructionsBtn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                instructionsBtn.classList.remove('playing');
            }

            if (currentAudio && currentAudio !== audio && !currentAudio.paused) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                currentBtn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                currentBtn.classList.remove('playing');
            }

            if (audio.paused) {
                audio.playbackRate = globalPlaybackSpeed;
                audio.play();
                btn.innerHTML = '<span class="pause-icon">‚è∏</span>';
                btn.classList.add('playing');
                currentAudio = audio;
                currentBtn = btn;
            } else {
                audio.pause();
                audio.currentTime = 0;
                btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                btn.classList.remove('playing');
                currentAudio = null;
                currentBtn = null;
            }
        }
    </script>
</body>

</html>