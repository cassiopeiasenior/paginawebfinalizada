<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Narrativa Sonora</title>
    <link rel="stylesheet" href="narrativasonora_styles.css">
</head>

<body>
    <!-- Fondo de estrellas -->
    <div class="stars" id="starsContainer"></div>

    <!-- Bot√≥n de regreso -->
    <a href="index_spanish.html" class="back-btn" title="Volver al Portal">
        üè†
    </a>

    <!-- Contenedor principal -->
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîä Narrativa Sonora üîä</h1>
            <p>Explora el universo a trav√©s del sonido. Descubre t√©rminos astron√≥micos explicados de manera accesible.</p>

            <!-- Bot√≥n de instrucciones -->
            <div class="instructions-container">
                <button class="audio-btn instructions-btn" onclick="playInstructions()" id="instructionsBtn">
                    <span class="play-icon">‚ñ∂</span>
                </button>
                <span class="instructions-label">Instrucciones</span>
            </div>

            <!-- Selector de velocidad -->
            <div class="speed-selector">
                <label for="globalSpeed">Velocidad de Reproducci√≥n:</label>
                <select id="globalSpeed" onchange="changeGlobalSpeed()">
                    <option value="0.5">0.5x (Muy Lento)</option>
                    <option value="0.75">0.75x (Lento)</option>
                    <option value="1" selected>1x (Normal)</option>
                    <option value="1.25">1.25x (R√°pido)</option>
                    <option value="1.5">1.5x (Muy R√°pido)</option>
                </select>
            </div>
        </div>

        <!-- Grid de narrativas -->
        <div class="narrative-grid">

            <!-- Narrativa 1 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/atmosferaesp.m4a">
                <h3 class="narrative-title">Atm√≥sfera</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/atmosfera.PNG');">
                    <button class="audio-btn" onclick="playAudio(0)" id="audioBtn0">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio0" src="assets/narrativasonora/audio/audioatmosferaespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 2 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/auroraesp.m4a">
                <h3 class="narrative-title">Aurora Boreal</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/aurora.jpg'); background-position: center; background-size: cover;">
                    <button class="audio-btn" onclick="playAudio(1)" id="audioBtn1">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio1" src="assets/narrativasonora/audio/audioauroraespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 3 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/climaespacialesp.m4a">
                <h3 class="narrative-title">Clima Espacial</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/climaespacial.PNG');">
                    <button class="audio-btn" onclick="playAudio(2)" id="audioBtn2">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio2" src="assets/narrativasonora/audio/audioclimaespacialespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 4 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/eyeccionesp.m4a">
                <h3 class="narrative-title">Eyecci√≥n de Masa Coronal</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/eyeccion.PNG');">
                    <button class="audio-btn" onclick="playAudio(3)" id="audioBtn3">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio3" src="assets/narrativasonora/audio/audioeyeccionespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 5 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/heliosferaesp.m4a">
                <h3 class="narrative-title">Heli√≥sfera</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/heliosfera.png');">
                    <button class="audio-btn" onclick="playAudio(4)" id="audioBtn4">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio4" src="assets/narrativasonora/audio/audioheliosferaespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 6 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/orbitaesp.m4a">
                <h3 class="narrative-title">√ìrbita</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/orbita.JPG');">
                    <button class="audio-btn" onclick="playAudio(5)" id="audioBtn5">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio5" src="assets/narrativasonora/audio/audioorbitaespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 7 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/llamaradaesp.m4a">
                <h3 class="narrative-title">Llamarada Solar</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/llamarada.png');">
                    <button class="audio-btn" onclick="playAudio(6)" id="audioBtn6">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio6" src="assets/narrativasonora/audio/audiollamaradasolarespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 8 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/manchaesp.m4a">
                <h3 class="narrative-title">Mancha Solar</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/manchasolar.png');">
                    <button class="audio-btn" onclick="playAudio(7)" id="audioBtn7">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio7" src="assets/narrativasonora/audio/audiomanchassolarespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 9 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/radiacionesp.m4a">
                <h3 class="narrative-title">Radiaci√≥n</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/radiacion.png');">
                    <button class="audio-btn" onclick="playAudio(8)" id="audioBtn8">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio8" src="assets/narrativasonora/audio/audioradiacionespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 10 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/sateliteesp.m4a">
                <h3 class="narrative-title">Sat√©lite</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/satelite.png');">
                    <button class="audio-btn" onclick="playAudio(9)" id="audioBtn9">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio9" src="assets/narrativasonora/audio/audiosateliteespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 11 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/tormentaesp.m4a">
                <h3 class="narrative-title">Tormenta Solar</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/tormentasolar.png');">
                    <button class="audio-btn" onclick="playAudio(10)" id="audioBtn10">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio10" src="assets/narrativasonora/audio/audiotormentaespanol.m4a"></audio>
                </div>
            </div>

            <!-- Narrativa 12 -->
            <div class="narrative-card" data-hover-audio="assets/narrativasonora/hover/vientoesp.m4a">
                <h3 class="narrative-title">Viento Solar</h3>
                <div class="audio-container" style="background-image: url('assets/narrativasonora/images/vientosolar.png');">
                    <button class="audio-btn" onclick="playAudio(11)" id="audioBtn11">
                        <span class="play-icon">‚ñ∂</span>
                    </button>
                    <audio id="audio11" src="assets/narrativasonora/audio/audiovientoespanol.m4a"></audio>
                </div>
            </div>

        </div>
    </div>

    <script>
        // ===== VARIABLES GLOBALES DE AUDIO =====
        let currentAudio = null;
        let currentBtn = null;
        let instructionsAudio = null;
        let hoverSounds = {};
        let globalPlaybackSpeed = 1;

        // ===== INICIALIZACI√ìN =====
        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            initializeAudioPlayers();
            addHoverSounds();
        });

        // ===== CREACI√ìN DE ESTRELLAS =====
        function createStars() {
            const starsContainer = document.getElementById('starsContainer');
            const numStars = 150;

            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // ===== INICIALIZAR REPRODUCTORES =====
        function initializeAudioPlayers() {
            // Crear elemento de audio para instrucciones
            instructionsAudio = new Audio('assets/narrativasonora/audio/audiointroduccionespanol.m4a');

            // Agregar listeners a todos los audios
            for (let i = 0; i < 12; i++) {
                const audio = document.getElementById(`audio${i}`);
                const btn = document.getElementById(`audioBtn${i}`);

                audio.addEventListener('ended', () => {
                    btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                    btn.classList.remove('playing');
                });
            }

            // Listener para audio de instrucciones
            instructionsAudio.addEventListener('ended', () => {
                const btn = document.getElementById('instructionsBtn');
                btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                btn.classList.remove('playing');
            });
        }

        // ===== AGREGAR SONIDOS DE HOVER =====
        function addHoverSounds() {
            // Agregar hover a todas las tarjetas con su propio audio
            const narrativeCards = document.querySelectorAll('.narrative-card');

            narrativeCards.forEach((card, index) => {
                const hoverAudioSrc = card.getAttribute('data-hover-audio');
                
                // Crear un objeto Audio para cada tarjeta
                if (hoverAudioSrc) {
                    hoverSounds[index] = new Audio(hoverAudioSrc);
                    hoverSounds[index].volume = 0.3;
                }

                card.addEventListener('mouseenter', () => {
                    if (hoverSounds[index]) {
                        playHoverSound(index);
                    }
                });
            });

            // Agregar hover al bot√≥n de instrucciones
            const instructionsBtn = document.getElementById('instructionsBtn');
            hoverSounds['instructions'] = new Audio('assets/narrativasonora/audio/hoverinstrucciones.mp3');
            hoverSounds['instructions'].volume = 0.3;
            
            instructionsBtn.addEventListener('mouseenter', () => {
                playHoverSound('instructions');
            });

            // Agregar hover al bot√≥n de regreso
            const backBtn = document.querySelector('.back-btn');
            hoverSounds['back'] = new Audio('assets/narrativasonora/audio/hoverback.mp3');
            hoverSounds['back'].volume = 0.3;
            
            backBtn.addEventListener('mouseenter', () => {
                playHoverSound('back');
            });
        }

        // ===== REPRODUCIR SONIDO DE HOVER =====
        function playHoverSound(key) {
            if (hoverSounds[key]) {
                hoverSounds[key].currentTime = 0;
                hoverSounds[key].play().catch(error => {
                    console.log('No se pudo reproducir el sonido hover:', error);
                });
            }
        }

        // ===== REPRODUCIR AUDIO DE INSTRUCCIONES =====
        function playInstructions() {
            const btn = document.getElementById('instructionsBtn');

            // Detener cualquier audio que est√© reproduci√©ndose
            if (currentAudio && !currentAudio.paused) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                if (currentBtn) {
                    currentBtn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                    currentBtn.classList.remove('playing');
                }
            }

            // Toggle del audio de instrucciones
            if (instructionsAudio.paused) {
                instructionsAudio.playbackRate = globalPlaybackSpeed;
                instructionsAudio.play();
                btn.innerHTML = '<span class="pause-icon">‚è∏</span>';
                btn.classList.add('playing');
            } else {
                instructionsAudio.pause();
                instructionsAudio.currentTime = 0;
                btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                btn.classList.remove('playing');
            }
        }

        // ===== CAMBIAR VELOCIDAD GLOBAL =====
        function changeGlobalSpeed() {
            const select = document.getElementById('globalSpeed');
            globalPlaybackSpeed = parseFloat(select.value);

            // Aplicar a todos los audios de narrativas
            for (let i = 0; i < 12; i++) {
                const audio = document.getElementById(`audio${i}`);
                if (audio) {
                    audio.playbackRate = globalPlaybackSpeed;
                }
            }

            // Aplicar al audio de instrucciones
            if (instructionsAudio) {
                instructionsAudio.playbackRate = globalPlaybackSpeed;
            }
        }

        // ===== REPRODUCIR AUDIO DE NARRATIVAS =====
        function playAudio(index) {
            const audio = document.getElementById(`audio${index}`);
            const btn = document.getElementById(`audioBtn${index}`);

            // Detener audio de instrucciones si est√° reproduci√©ndose
            if (instructionsAudio && !instructionsAudio.paused) {
                instructionsAudio.pause();
                instructionsAudio.currentTime = 0;
                const instructionsBtn = document.getElementById('instructionsBtn');
                instructionsBtn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                instructionsBtn.classList.remove('playing');
            }

            // Si hay un audio reproduci√©ndose diferente, detenerlo
            if (currentAudio && currentAudio !== audio && !currentAudio.paused) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                currentBtn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                currentBtn.classList.remove('playing');
            }

            // Toggle del audio actual
            if (audio.paused) {
                audio.playbackRate = globalPlaybackSpeed;
                audio.play();
                btn.innerHTML = '<span class="pause-icon">‚è∏</span>';
                btn.classList.add('playing');
                currentAudio = audio;
                currentBtn = btn;
            } else {
                audio.pause();
                audio.currentTime = 0;
                btn.innerHTML = '<span class="play-icon">‚ñ∂</span>';
                btn.classList.remove('playing');
                currentAudio = null;
                currentBtn = null;
            }
        }
    </script>
</body>

</html>